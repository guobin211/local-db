# local-db 客户端需求说明

## 一、概述

### 1.1 产品定位

local-db 是一个跨平台的数据库管理工具，旨在简化本地开发环境中多种数据库的安装、配置和管理流程。通过提供统一的图形化界面，让开发者能够快速搭建和管理本地数据库环境。

### 1.2 核心特性

- **多数据库支持**：MySQL、PostgreSQL、MongoDB、Redis、Qdrant、Neo4j、SeekDB、SurrealDB
- **跨平台兼容**：Windows、macOS、Linux
- **GUI操作**：图形化界面（GUI）
- **统一管理**：集中式的数据库安装、配置、启停、备份管理
- **开发友好**：快速部署、一键启停、配置持久化

### 1.3 技术架构

- **GUI 框架**：Tauri（Rust + React）
- **前端技术栈**：React + TypeScript + TailwindCSS + Zustand
- **后端技术栈**：Rust + Tokio
- **数据持久化**：Tauri Store 插件

## 二、核心功能

### 2.1 数据库下载安装

**功能描述**：

- 支持从官方源下载指定版本的数据库二进制包
- 自动解压并配置到统一的存储目录
- 支持版本选择和架构适配（AMD64/ARM64）
- 提供安装进度显示和错误处理
- **限制**：每种数据库类型最多只能安装 1 个实例

**用户场景**：

- 开发者需要快速安装特定版本的数据库
- 团队统一数据库版本，避免环境差异

### 2.2 数据库运行管理

**功能描述**：

- 启动数据库服务，支持自定义端口、数据目录、用户名密码等参数
- 停止数据库服务，确保数据安全关闭
- 重启数据库服务
- 查看数据库运行状态（运行中/已停止）
- 查看数据库进程信息和资源占用

**用户场景**：

- 开发过程中频繁启停数据库
- 切换不同项目时需要启动对应的数据库
- 排查数据库性能问题时查看资源占用

### 2.3 数据库配置管理

**功能描述**：

- 持久化数据库配置信息（端口、数据目录、用户凭证等）
- 支持配置文件的可视化编辑
- 配置模板管理，快速应用常用配置
- 配置导入导出，方便团队共享

**用户场景**：

- 保存常用的数据库配置，避免重复输入
- 团队成员共享统一的数据库配置

### 2.4 数据库备份恢复

**功能描述**：

- 支持数据库数据备份到指定路径
- 支持从备份文件恢复数据
- 定时备份功能（可选）
- 备份文件管理和清理

**用户场景**：

- 重要数据定期备份
- 数据迁移或环境重建时快速恢复

### 2.5 数据库删除

**功能描述**：

- 删除已安装的数据库
- 可选择是否同时删除数据文件
- 删除前二次确认，防止误操作

**用户场景**：

- 清理不再使用的数据库
- 释放磁盘空间

### 2.6 数据库列表查看

**功能描述**：

- 显示所有已安装的数据库
- 显示数据库版本、状态、端口、数据目录等信息
- 支持按类型、状态筛选

**用户场景**：

- 快速了解本地数据库环境
- 查找特定数据库的配置信息

## 三、平台实现方案

### 3.1 各平台的具体实现方案参考

各操作系统平台的数据库安装配置方案详见以下文档：

- **Windows 平台**：[docs/windows.md](./docs/windows.md)
  - 使用二进制包和 MSI 安装包
  - 统一存储路径：`D:\.local-db`
  - 支持 AMD64/ARM64 架构

- **macOS 平台**：[docs/macos.md](./docs/macos.md)
  - 使用官方二进制包
  - 统一存储路径：`~/.local-db`
  - 支持 Intel/Apple Silicon 架构
  - 使用 LaunchAgents 管理服务

- **Linux 平台**：[docs/linux.md](./docs/linux.md)
  - 使用官方二进制包
  - 统一存储路径：`~/.local-db`
  - 支持 AMD64/ARM64 架构
  - 使用 systemd 管理服务

### 3.2 统一目录结构

所有平台遵循统一的目录结构：

```
~/.local-db/
├── bin/              # 数据库二进制文件
│   ├── mysql/
│   ├── mongodb/
│   ├── redis/
│   └── ...
├── config/           # 数据库配置文件
│   ├── mysql.conf
│   ├── mongodb.conf
│   └── ...
├── data/             # 数据库数据目录
│   ├── mysql/
│   ├── mongodb/
│   └── ...
├── logs/             # 数据库日志目录
│   ├── mysql/
│   ├── mongodb/
│   └── ...
└── backups/          # 数据库备份目录
    ├── mysql/
    ├── mongodb/
    └── ...
```

## 四、Tauri 客户端功能（GUI）

### 4.1 设计稿

参考设计稿：[screen.png](./screen.png)

### 4.2 核心功能模块

#### 4.2.1 数据库列表页面

**功能描述**：

- 展示所有已安装的数据库，以卡片形式呈现
- 每个数据库卡片显示：
  - 数据库图标和名称
  - 版本号
  - 运行状态（运行中/已停止）
  - 端口号
  - 快捷操作按钮（启动/停止/重启/删除）
- 支持按类型筛选（关系型/NoSQL/缓存/向量/图数据库）
- 支持按状态筛选（运行中/已停止）
- 支持搜索功能

**交互设计**：

- 点击卡片进入数据库详情页
- 快捷操作按钮支持一键启停
- 删除操作需二次确认

#### 4.2.2 数据库安装页面

**功能描述**：

- 展示支持的数据库列表
- 已安装的数据库类型显示为禁用状态（每种数据库最多 1 个实例）
- 选择数据库类型后，显示可用版本列表
- 配置安装参数：
  - 安装路径
  - 数据目录
  - 日志目录
  - 默认端口
  - 用户名密码（如适用）
- 显示安装进度和日志
- 安装完成后自动跳转到数据库列表

**交互设计**：

- 版本选择支持下拉列表
- 路径选择支持文件浏览器
- 安装过程中显示进度条和实时日志
- 支持取消安装
- 已安装的数据库类型置灰显示，提示"已安装"

#### 4.2.3 数据库详情页面

**功能描述**：

- 显示数据库基本信息：
  - 名称、版本、类型
  - 安装路径、数据路径、日志路径
  - 运行状态、进程 ID
  - 端口号、用户凭证
- 显示数据库配置信息（可编辑）
- 显示数据库运行日志（实时更新）
- 显示资源占用情况（CPU、内存、磁盘）
- 操作按钮：
  - 启动/停止/重启
  - 备份/恢复
  - 编辑配置
  - 删除数据库

**交互设计**：

- 配置编辑支持语法高亮
- 日志支持搜索和筛选
- 资源占用以图表形式展示

#### 4.2.4 备份管理页面

**功能描述**：

- 展示所有数据库的备份文件列表
- 每个备份显示：
  - 数据库名称
  - 备份时间
  - 文件大小
  - 备份路径
- 操作功能：
  - 创建新备份
  - 恢复备份
  - 删除备份
  - 导出备份文件

**交互设计**：

- 支持按数据库筛选
- 支持按时间排序
- 恢复操作需二次确认

#### 4.2.5 设置页面

**功能描述**：

- 全局配置：
  - 默认存储路径
  - 应用开机自启动（启动 Tauri 客户端）
  - 主题设置（亮色/暗色）
  - 语言设置
- 数据库自启动配置：
  - 为每个数据库配置是否随应用启动
  - 应用启动后，Rust 后端自动启动标记为自启动的数据库
- 数据库默认配置：
  - 各数据库的默认端口
  - 默认用户名密码
  - 默认数据目录
- 备份配置：
  - 自动备份开关
  - 备份频率
  - 备份保留天数
- 日志配置：
  - 日志级别
  - 日志保留天数

**交互设计**：

- 配置修改后自动保存
- 开机自启动支持一键切换

#### 4.2.6 日志查看功能

**功能描述**：

- 支持查看各数据库的运行日志
- 支持查看 local-db 自身的日志
- 日志功能：
  - 实时更新
  - 搜索和筛选
  - 按级别筛选（INFO/WARN/ERROR）
  - 导出日志文件
  - 清空日志

**交互设计**：

- 日志以终端样式展示
- 支持自动滚动到底部
- 错误日志高亮显示

#### 5.3.2 进程管理

- 使用 Rust 的 `std::process::Command` 管理数据库进程
- 记录进程 PID，支持进程状态查询
- 支持优雅关闭和强制关闭
- Tauri 客户端启动后，由 Rust 后端自动启动配置为自启动的数据库

#### 5.3.3 日志管理

- 使用 `tracing` 和 `tracing-subscriber` 记录应用日志
- 日志文件按日期轮转
- 支持日志级别配置

### 5.4 开发优先级

**第一阶段（MVP）**：

1. 数据库列表页面
2. 数据库安装功能
3. 数据库启停功能
4. 基本配置管理
5. 优先支持 macOS 系统

**第二阶段**：

1. 数据库详情页面
2. 备份恢复功能
3. 日志查看功能
4. 资源监控功能
5. 数据库自启动功能

**第三阶段**：

1. 设置页面
2. 应用开机自启动
3. 自动备份
4. Windows 和 Linux 平台支持

## 六、支持的数据库

### 6.1 关系型数据库

| 数据库     | 默认端口 | 优先级 | 备注                 |
| ---------- | -------- | ------ | -------------------- |
| MySQL      | 3306     | P0     | 最常用的关系型数据库 |
| PostgreSQL | 5432     | P0     | 功能强大的开源数据库 |

### 6.2 NoSQL 数据库

| 数据库    | 默认端口 | 优先级 | 备注         |
| --------- | -------- | ------ | ------------ |
| MongoDB   | 27017    | P0     | 文档型数据库 |
| SurrealDB | 8000     | P1     | 多模型数据库 |

### 6.3 缓存数据库

| 数据库 | 默认端口 | 优先级 | 备注             |
| ------ | -------- | ------ | ---------------- |
| Redis  | 6379     | P0     | 高性能缓存数据库 |

### 6.4 向量数据库

| 数据库 | 默认端口 | 优先级 | 备注         |
| ------ | -------- | ------ | ------------ |
| Qdrant | 6333     | P1     | 向量搜索引擎 |

### 6.5 图数据库

| 数据库 | 默认端口  | 优先级 | 备注     |
| ------ | --------- | ------ | -------- |
| Neo4j  | 7474/7687 | P1     | 图数据库 |

### 6.6 其他数据库

| 数据库 | 默认端口 | 优先级 | 备注         |
| ------ | -------- | ------ | ------------ |
| SeekDB | 8080     | P2     | 轻量级数据库 |

**优先级说明**：

- P0：第一阶段必须支持
- P1：第二阶段支持
- P2：第三阶段支持

## 七、非功能性需求

### 7.1 性能要求

- 应用启动时间 < 3 秒
- 数据库启动响应时间 < 5 秒
- 界面操作响应时间 < 500ms
- 支持同时管理多种数据库类型（每种类型 1 个实例）

### 7.2 安全要求

- 数据库密码加密存储
- 支持配置文件权限管理
- 备份文件支持加密
- 敏感信息不记录到日志

### 7.3 稳定性要求

- 应用崩溃后自动恢复
- 数据库异常退出后自动重启（可配置）
- 完善的错误处理和日志记录
- 支持数据库进程监控和告警

### 7.4 易用性要求

- 界面简洁直观，符合现代设计规范
- 操作流程简单，减少用户学习成本
- 提供详细的错误提示和解决方案
- 支持快捷键操作

### 7.5 兼容性要求

- 支持 macOS 10.15+
- 支持 Windows 10/11
- 支持主流 Linux 发行版（Ubuntu、CentOS、Debian 等）
- 支持 AMD64 和 ARM64 架构

## 八、项目规划

### 8.1 开发阶段

**阶段一：MVP 版本（1-2 个月）**

- 完成 GUI 基础框架
- 支持 MySQL、PostgreSQL、MongoDB、Redis
- 优先支持 macOS 平台

**阶段二：功能完善（2-3 个月）**

- 完善 GUI 功能（详情页、备份管理、日志查看）
- 支持 Qdrant、Neo4j、SurrealDB
- 支持 Windows 平台

**阶段三：优化增强（1-2 个月）**

- 性能优化和稳定性提升
- 支持 SeekDB
- 支持 Linux 平台
- 自动备份和监控告警功能

## 九、附录

### 9.1 参考资料

- [Tauri 官方文档](https://tauri.app/)
- [Tauri Store 插件文档](https://v2.tauri.app/plugin/store/)
- [MySQL 官方文档](https://dev.mysql.com/doc/)
- [PostgreSQL 官方文档](https://www.postgresql.org/docs/)
- [MongoDB 官方文档](https://docs.mongodb.com/)
- [Redis 官方文档](https://redis.io/documentation)

### 9.2 更新日志

- 2026-01-11：初始版本，完善需求文档
- 2026-01-11：更新数据持久化方案，采用 Tauri Store 插件
- 2026-01-11：删除开机自启动章节，改为由 Rust 后端在应用启动时自动启动配置的数据库
